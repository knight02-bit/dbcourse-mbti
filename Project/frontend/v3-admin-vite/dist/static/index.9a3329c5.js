import{d as e,M as l,A as a,t,p as u,r as d,o,c as n,a as s,j as r,w as i,l as m,S as c,R as v,G as p,Q as f,P as b}from"./index.22c1f384.js";const g={class:"app-container"},h=p("🔍"),S=p("Delete"),_=p("新增学生"),V={class:"demo-drawer__content"},x={class:"example-block"},w={class:"demo-drawer__footer"},y=p("取消"),C=p("提交"),T=e({name:"index",setup(e){const p=l(""),T=l("id"),k=a().roles,U=l([]);t((()=>{"student"==k[0]&&v.alert("非管理员不可使用","WARN",{confirmButtonText:" ✔ "})}));const B=()=>{"student"==k[0]?v.alert("非管理员不可使用","WARN",{confirmButtonText:" ✔ "}):D.value=!0},R="80px";let A;const D=l(!1),G=l(!1),N=u({Sid:"",Sname:"",Cid:"",Dname:"",CGname:""}),W=l(),j=()=>{G.value||v.confirm("你想要提交吗?").then((()=>{G.value=!0,A=setTimeout((()=>{setTimeout((()=>{G.value=!1}),400)}),2e3)})).catch((()=>{}))},q=()=>{G.value=!1,D.value=!1,clearTimeout(A)},M=l([]),z=l([]),H=()=>{let e=!0;if(null==M.value[0]||null==M.value[1]||null==M.value[2])e=!1;else if(0==N.Sname.length||10!=N.Sid.length)e=!1;else for(var l=0;l<N.Sid.length;l++)if(N.Sid[l]>"9"||N.Sid[l]<"0"){e=!1;break}e?(z.value=[{Sid:N.Sid,Sname:N.Sname,CGname:M.value[0],Dname:M.value[1],Cid:M.value[2]}],f({url:"/student-add",method:"post",data:z.value[0]}).then((e=>{e.data.isSuccess?b({message:"新增成功",type:"success"}):b.error("新增失败, 该学号已被使用")})),W.value.close()):v.alert("","🚩 Tip ",{message:"信息不全or格式有误",confirmButtonText:"OK",dangerouslyUseHTMLString:!0,callback:()=>{b({type:"info",message:"☆ 小提示: 学号为10位数字 ☆ "})}})},I=u({sname:[{required:!0,message:"请输入姓名",trigger:"blur"}],sid:[{required:!0,message:"请输入十位的学号",trigger:"blur"}]}),K=[{value:"计算机科学与工程学院",label:"计算机科学与工程学院",children:[{value:"软件工程",label:"软件工程",children:[{value:"201",label:"201"},{value:"202",label:"202"},{value:"203",label:"203"},{value:"204",label:"204"}]},{value:"网络工程",label:"网络工程",children:[{value:"201",label:"201"},{value:"202",label:"202"},{value:"203",label:"203"},{value:"204",label:"204"}]},{value:"计算机科学与技术",label:"计算机科学与技术",children:[{value:"201",label:"201"},{value:"202",label:"202"},{value:"203",label:"203"},{value:"204",label:"204"}]}]}];return(e,l)=>{const a=d("el-button"),t=d("el-option"),u=d("el-select"),A=d("el-input"),z=d("el-table-column"),L=d("el-table"),O=d("center"),P=d("el-form-item"),Q=d("el-cascader"),$=d("el-form");return o(),n("div",g,[s("div",null,[r(A,{modelValue:p.value,"onUpdate:modelValue":l[2]||(l[2]=e=>p.value=e),stripe:"",placeholder:"右边选择查询方式:  学院 / 系别 / 班级 / 学号 / 名字",class:"input-with-select"},{prepend:i((()=>[r(a,{onClick:l[0]||(l[0]=e=>(e=>{if("student"==k[0])v.alert("非管理员不可使用","WARN",{confirmButtonText:" ✔ "});else{let t="";if("cg"==T.value)t+="/info-cg/"+e;else if("dep"==T.value)t+="/info-dep/"+e;else if("depclass"==T.value){for(var l=0,a=0;a<e.length;a++)if(e[a]>="0"&&e[a]<="9"){l=a;break}t+="/info-depclass/"+e.substring(0,l)+"/"+e.substring(l,e.length)}else"id"==T.value?t+="/info-id/"+e:"name"==T.value&&(t+="/info-name/"+e);f({url:t,method:"get"}).then((e=>{U.value=e.data.studentInfoes}))}})(p.value))},{default:i((()=>[h])),_:1})])),append:i((()=>[r(u,{modelValue:T.value,"onUpdate:modelValue":l[1]||(l[1]=e=>T.value=e),placeholder:"选择",style:{width:"200px"}},{default:i((()=>[r(t,{label:"学院(如: 计算机科学与工程学院)",value:"cg"}),r(t,{label:"系别(如: 软件工程)",value:"dep"}),r(t,{label:"班级(系别+班级号, 如: 软件工程202)",value:"depclass"}),r(t,{label:"学号",value:"id"}),r(t,{label:"名字",value:"name"})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])]),r(L,{data:U.value,stripe:"",style:{width:"100%"}},{default:i((()=>[r(z,{prop:"Sid",label:"学号",sortable:""}),r(z,{prop:"Sname",label:"姓名",sortable:""}),r(z,{prop:"CGname",label:"学院",sortable:""}),r(z,{prop:"Dname",label:"系别",sortable:""}),r(z,{prop:"Cid",label:"班级",sortable:""}),r(z,{label:"删除"},{default:i((e=>[r(a,{size:"large",type:"danger",onClick:l=>{return e.$index,a=e.row,void v.confirm("是否要删除"+a.Sid,"WARN",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{f({url:"/del-student",method:"delete",data:a}),b({type:"success",message:"删除成功"})})).catch((()=>{b({type:"info",message:"取消删除操作"})}));var a}},{default:i((()=>[S])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),r(O,null,{default:i((()=>[r(a,{type:"success",onClick:B},{default:i((()=>[_])),_:1})])),_:1}),r(m(c),{ref_key:"drawerRef",ref:W,modelValue:D.value,"onUpdate:modelValue":l[6]||(l[6]=e=>D.value=e),title:"请填入相关信息","before-close":j,direction:"ltr","custom-class":"demo-drawer"},{default:i((()=>[s("div",V,[r($,{model:N,rules:I,"status-icon":""},{default:i((()=>[r(P,{label:"姓名","label-width":R,prop:"Sname"},{default:i((()=>[r(A,{modelValue:N.Sname,"onUpdate:modelValue":l[3]||(l[3]=e=>N.Sname=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),r(P,{label:"学号","label-width":R,prop:"Sid"},{default:i((()=>[r(A,{modelValue:N.Sid,"onUpdate:modelValue":l[4]||(l[4]=e=>N.Sid=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),r(P,{label:"","label-width":R},{default:i((()=>[s("div",x,[r(Q,{modelValue:M.value,"onUpdate:modelValue":l[5]||(l[5]=e=>M.value=e),options:K,expandTrigger:"hover"},null,8,["modelValue"])])])),_:1}),r(P,null,{default:i((()=>[r(O,null,{default:i((()=>[s("div",w,[r(a,{onClick:q},{default:i((()=>[y])),_:1}),r(a,{type:"primary",loading:G.value,onClick:H},{default:i((()=>[C])),_:1},8,["loading"])])])),_:1})])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue"])])}}});export{T as default};
