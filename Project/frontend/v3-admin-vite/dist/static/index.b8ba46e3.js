import{d as e,M as l,A as a,t,p as u,r as d,o,c as s,a as n,j as r,w as i,l as c,S as m,F as v,R as p,P as f,G as b,Q as g}from"./index.cc14eb3f.js";const h={class:"app-container"},S=b("🔍"),_=b("Delete"),V=b("新增学生"),x={class:"demo-drawer__content"},y={class:"example-block"},w={class:"demo-drawer__footer"},C=b("取消"),T=b("提交"),k=e({name:"index",setup(e){const b=l(""),k=l("id"),U=a().roles,B=l([]);t((()=>{"student"==U[0]?p.alert("非管理员不可使用","WARN",{confirmButtonText:" ✔ "}):f({message:"若无显示,请进行刷新",type:"success"})}));const R=()=>{"student"==U[0]?p.alert("非管理员不可使用","WARN",{confirmButtonText:" ✔ "}):G.value=!0},A="80px";let D;const G=l(!1),N=l(!1),W=u({Sid:"",Sname:"",Cid:"",Dname:"",CGname:""}),j=l(),q=()=>{N.value||p.confirm("你想要提交吗?").then((()=>{N.value=!0,D=setTimeout((()=>{setTimeout((()=>{N.value=!1}),400)}),2e3)})).catch((()=>{}))},M=()=>{N.value=!1,G.value=!1,clearTimeout(D)},z=l([]),F=l([]),H=()=>{let e=!0;if(null==z.value[0]||null==z.value[1]||null==z.value[2])e=!1;else if(0==W.Sname.length||10!=W.Sid.length)e=!1;else for(var l=0;l<W.Sid.length;l++)if(W.Sid[l]>"9"||W.Sid[l]<"0"){e=!1;break}e?(F.value=[{Sid:W.Sid,Sname:W.Sname,CGname:z.value[0],Dname:z.value[1],Cid:z.value[2]}],g({url:"/student-add",method:"post",data:F.value[0]}).then((e=>{e.data.isSuccess?f({message:"新增成功",type:"success"}):f.error("新增失败, 该学号已被使用")})),j.value.close()):p.alert("","🚩 Tip ",{message:"信息不全or格式有误",confirmButtonText:"OK",dangerouslyUseHTMLString:!0,callback:()=>{f({type:"info",message:"☆ 小提示: 学号为10位数字 ☆ "})}})},I=u({sname:[{required:!0,message:"请输入姓名",trigger:"blur"}],sid:[{required:!0,message:"请输入十位的学号",trigger:"blur"}]}),K=[{value:"计算机科学与工程学院",label:"计算机科学与工程学院",children:[{value:"软件工程",label:"软件工程",children:[{value:"201",label:"201"},{value:"202",label:"202"},{value:"203",label:"203"},{value:"204",label:"204"}]},{value:"网络工程",label:"网络工程",children:[{value:"201",label:"201"},{value:"202",label:"202"},{value:"203",label:"203"},{value:"204",label:"204"}]},{value:"计算机科学与技术",label:"计算机科学与技术",children:[{value:"201",label:"201"},{value:"202",label:"202"},{value:"203",label:"203"},{value:"204",label:"204"}]}]}];return(e,l)=>{const a=d("el-button"),t=d("el-option"),u=d("el-select"),D=d("el-input"),F=d("el-table-column"),L=d("el-table"),O=d("center"),P=d("el-form-item"),Q=d("el-cascader"),$=d("el-form");return o(),s(v,null,[n("div",h,[n("div",null,[r(D,{modelValue:b.value,"onUpdate:modelValue":l[2]||(l[2]=e=>b.value=e),stripe:"",placeholder:"右边选择查询方式:  学院 / 系别 / 班级 / 学号 / 名字",class:"input-with-select"},{prepend:i((()=>[r(a,{onClick:l[0]||(l[0]=e=>(e=>{if("student"==U[0])p.alert("非管理员不可使用","WARN",{confirmButtonText:" ✔ "});else{let t="";if("cg"==k.value)t+="/info-cg/"+e;else if("dep"==k.value)t+="/info-dep/"+e;else if("depclass"==k.value){for(var l=0,a=0;a<e.length;a++)if(e[a]>="0"&&e[a]<="9"){l=a;break}t+="/info-depclass/"+e.substring(0,l)+"/"+e.substring(l,e.length)}else"id"==k.value?t+="/info-id/"+e:"name"==k.value&&(t+="/info-name/"+e);g({url:t,method:"get"}).then((e=>{B.value=e.data.studentInfoes}))}})(b.value))},{default:i((()=>[S])),_:1})])),append:i((()=>[r(u,{modelValue:k.value,"onUpdate:modelValue":l[1]||(l[1]=e=>k.value=e),placeholder:"选择",style:{width:"200px"}},{default:i((()=>[r(t,{label:"学院(如: 计算机科学与工程学院)",value:"cg"}),r(t,{label:"系别(如: 软件工程)",value:"dep"}),r(t,{label:"班级(系别+班级号, 如: 软件工程202)",value:"depclass"}),r(t,{label:"学号",value:"id"}),r(t,{label:"名字",value:"name"})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])]),r(L,{data:B.value,stripe:"",style:{width:"100%"}},{default:i((()=>[r(F,{prop:"Sid",label:"学号",sortable:""}),r(F,{prop:"Sname",label:"姓名",sortable:""}),r(F,{prop:"CGname",label:"学院",sortable:""}),r(F,{prop:"Dname",label:"系别",sortable:""}),r(F,{prop:"Cid",label:"班级",sortable:""}),r(F,{label:"删除"},{default:i((e=>[r(a,{size:"large",type:"danger",onClick:l=>{return e.$index,a=e.row,void p.confirm("是否要删除"+a.Sid,"WARN",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{g({url:"/del-student",method:"delete",data:a}),f({type:"success",message:"删除成功"})})).catch((()=>{f({type:"info",message:"取消删除操作"})}));var a}},{default:i((()=>[_])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),r(O,null,{default:i((()=>[r(a,{type:"success",onClick:R},{default:i((()=>[V])),_:1})])),_:1}),r(c(m),{ref_key:"drawerRef",ref:j,modelValue:G.value,"onUpdate:modelValue":l[6]||(l[6]=e=>G.value=e),title:"请填入相关信息","before-close":q,direction:"ltr","custom-class":"demo-drawer"},{default:i((()=>[n("div",x,[r($,{model:W,rules:I,"status-icon":""},{default:i((()=>[r(P,{label:"姓名","label-width":A,prop:"Sname"},{default:i((()=>[r(D,{modelValue:W.Sname,"onUpdate:modelValue":l[3]||(l[3]=e=>W.Sname=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),r(P,{label:"学号","label-width":A,prop:"Sid"},{default:i((()=>[r(D,{modelValue:W.Sid,"onUpdate:modelValue":l[4]||(l[4]=e=>W.Sid=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),r(P,{label:"","label-width":A},{default:i((()=>[n("div",y,[r(Q,{modelValue:z.value,"onUpdate:modelValue":l[5]||(l[5]=e=>z.value=e),options:K,expandTrigger:"hover"},null,8,["modelValue"])])])),_:1}),r(P,null,{default:i((()=>[r(O,null,{default:i((()=>[n("div",w,[r(a,{onClick:M},{default:i((()=>[C])),_:1}),r(a,{type:"primary",loading:N.value,onClick:H},{default:i((()=>[T])),_:1},8,["loading"])])])),_:1})])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue"])],64)}}});export{k as default};
